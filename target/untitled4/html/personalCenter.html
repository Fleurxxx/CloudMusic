<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>个人中心</title>
    <link href="../css/personalCenter.css" rel="stylesheet" type="text/css" />
    <script src="../js/jquery-3.2.1.js" type="text/javascript"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body>
<!--用户把点击加入歌单显示页面-->
<div class="addSongList_showDiv">
    <div class="addSongList_showDiv_header">添加到歌单<span title="关闭" id="none_addSongList_showDiv">+</span></div>
    <div class="addSongList_songList" songId>
        <!--用于显示用户创建的歌单-->
    </div>
</div>
<div class="personalCenter_content">
    <!--上边部分，用于显示用户头像，用户名、修改按钮-->
    <div class="Personal_top_div">
        <!--左侧用户头像显示-->
        <div class="Personal_userheader_img_div">
            <img class="Personal-headimg" id="msg-headimg" src="../img/images/头像2.png" alt="头像" width="100%" />
        </div>
        <!--右侧用户名，用户修改按钮，用户邮箱-->
        <div class="Personal_info_div">
            <p class="userName_and_setuserinfoBtn">
                <span id="msg_userName">未登录</span><!--用户名-->
                <span id="msg_userType">vip</span><!--会员状态-->
                <button class="msg-update" id="setting_userInfo" onclick=javascrtpt:jump()>编辑个人资料</button>
                <button class="msg-login" id="login" onclick=javascrtpt:logbt()>点击登录</button>
            </p>
            <p class="personal_userEmail_p">
                <p class="email_p">
                    <a>Email：</a><span id="msg_userEmail"></span>
                    <a>性别：</a><span id="msg_userSex"></span>
                    <a>村龄：</a><span id="msg_userBirth"></span><br/>
                    <a>简介：</a><span id="msg_userDetails"></span><br/>
                    <a>粉丝：</a><span id="msg_fans"></span>
                    <a>关注：</a><span id="msg_focus"></span>

                </p>
            </p>
        </div>
    </div>
    <!--中间部分，显示用户听歌记录-->
    <div class="listenSong_top">
        <h2 class="listensong_title">听歌排行Top20</h2>
        <table class="listensong_table" cellpadding="0" cellspacing="0">

        </table>
    </div>
    <!--下边部分，显示用户创建的歌单和收藏的歌单-->
    <!--用户创建的歌单-->
    <div class="personal_userCreateSongList">
        <h2 class="userCreateSongList_title">我创建的歌单</h2>
        <ul class="userCreateSongList_ul">

        </ul>
    </div>
    <div style="clear: both;"></div>
    <!--用户收藏的歌单-->
    <div class="personal_userCollectionSongList">
        <h2 class="userCollectionSongList_title">我收藏的歌单</h2>
        <ul class="userCollectionSongList_ul">
        </ul>
    </div>
</div>
<script>
    let interval;
    //初始化设置隐藏编辑按钮
    $(".msg-update").css("display","none");
    //jquery 页面加载初始化方法
    $(function() {
        {
            axios({
                method: 'POST',
                url: 'http://localhost:8080/userServlet?method=getUserMsg',
            }).then(function (response) {
                console.log(response);
                if(response.data.code===200) {//验证成功显示个人信息
                    $(".msg-update").show();
                    $(".msg-login").hide();
                    let data = response['data'];
                    $('#msg_userName').html(data['data']['user_name']);
                    $('#msg_userEmail').html(data['data']['email']);
                    $(".Personal-headimg").attr("src", data['data']['user_photo']);
                    let type = data['data']['user_type'];
                    if(type===1){
                        $('#msg_userType').html("vip");
                        $("#msg_userType").css("color","#D81E06");
                    }
                    let gender = data['data']['user_gender'];
                    console.log(gender);
                    if (gender === "男") {
                        $('#msg_userSex').html("男");
                    } else if(gender === "女") {
                        $('#msg_userSex').html("女");
                    } else {
                        $('#msg_userSex').html("暂不公开");
                    }
                    $('#msg_userBirth').html(data['data']['user_date']);<!--村龄-->
                    if (data['data']['user_detail'] == null) {
                        $('#msg_userDetails').html("这个人很懒,啥也没说。");
                    } else {
                        $('#msg_userDetails').html(data['data']['user_detail']);
                    }
                    $("#msg_fans").html(data['data']['num_fans']);
                    $("#msg_focus").html(data['data']['num_focus']);
                }else{
                    $(".msg-update").hide();
                    $(".msg-login").show();
                }

            })
        }

    });

    function jump(){
        window.location.href="personalSetting.html";
    }

    function logbt(){
        window.location.href="login.html";
    }
</script>
</body>
</html>
